theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 20) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," IMF Report")) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 16) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," IMF Report")) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 16) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
text_df=tibble(doc="2019",text=comp_text[1,3])
unnest_tokens(text_df, sent_tokens, text, token="sentences")%>%
get_sentences()%>%
sentiment()
temp=readtext(paste0(path, "/IMF Reports/imf_article_4_",i,".docx"))
temp=readtext(paste0(path, "/IMF Reports/imf_article_4_2019.docx"))
temp$text
dfs<- c("2010","2012","2014","2015","2016","2017","2018","2019")
comp_sentiment<- c()
for (i in dfs){
temp=readtext(paste0(path, "/IMF Reports/imf_article_4_",i,".docx"))
text_df=tibble(doc=i,text=temp$text)
temp_sentiment<- unnest_tokens(text_df, sent_tokens, text, token="sentences")%>%
get_sentences()%>%
sentiment()
comp_sentiment<- rbind(temp_sentiment,comp_sentiment)
}
comp_text<- c()
for (i in dfs){
temp=readtext(paste0(path, "/IMF Reports/imf_article_4_",i,".docx"))
comp_text<-rbind(temp, com_text)
}
for (i in dfs){
temp=readtext(paste0(path, "/IMF Reports/imf_article_4_",i,".docx"))
comp_text<-rbind(temp, comp_text)
}
(subset(comp_sentiment, doc="2019"))$sentiment
(subset(comp_sentiment, doc="2019")
(subset(comp_sentiment, doc="2019"))
subset(comp_sentiment, doc="2019")
subset(comp_sentiment, doc="2019")
plot_figs<-with(density((subset(comp_sentiment, doc="2019"))$sentiment), data.frame(x,y))
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(limits = c(0,2)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_discrete(breaks=0.25) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_discrete(breaks=seq(-3,3,0.10)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India")) +
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_discrete(breaks=seq(-3,3,0.10)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-3,3,0.10)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-3,3,0.5)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-3,3,0.5)) +
theme_minimal(base_size = 10) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-3,3,0.5)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-3,3,0.5)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme( axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-3,3,0.5)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-2,2,0.5)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-2,2,0.25)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-2,2,0.25))
ggplot(plot_figs, aes(x=x, y=y))+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,2)) +
scale_x_continuous(breaks=seq(-2,2,0.25))
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,1.5)) +
scale_x_continuous(breaks=seq(-2,2,0.25)) +
theme_minimal(base_size = 12) +
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,1.5)) +
scale_x_continuous(breaks=seq(-2,2,0.25)) +
theme_minimal(base_size = 12) +
x_lim(-2,2)+
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,1.5)) +
scale_x_continuous(breaks=seq(-2,2,0.25)) +
theme_minimal(base_size = 12) +
xlim(-2,2)+
labs(x = "Sentiment",
y = "",
title = paste0("The Distribution of Sentiment in ","2019"," Article IV IMF Report for India"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
ggplot(plot_figs, aes(x=x, y=y))+
geom_line()+
geom_area(mapping=aes(x=ifelse(x>=0, x,0)), fill="dark green")+
geom_area(mapping=aes(x=ifelse(x<=0, x,0)), fill="dark red")+
scale_y_continuous(limits = c(0,1.5)) +
scale_x_continuous(breaks=seq(-2,2,0.25)) +
theme_minimal(base_size = 12) +
xlim(-2,2)+
labs(x = "Sentiment",
y = "",
title = paste0("2019"," Article IV IMF Report for India: ","Sentiment Distribution"))+
theme(plot.title = element_text(hjust = 0.25),
axis.text.y=element_blank())
df_udp <- udpipe(comp_text, "english")
df_udp$stem<- wordStem(df_udp$token, language = "porter")
View(df_udp)
df_udp
df_udp%>%
filter(upos!="NUM"&upos!="PUNCT"&upos!="SYM")%>%
left_join(get_sentiments("nrc"), by = c("token" = "word")) %>%
#Understanding dependency parsing for economy
df_econ<- df_udp%>%
filter(stem=="economi")
#Understanding dependency parsing for economy
df_econ<- df_udp%>%
filter(stem=="economi")
df_econ
df_udd_depend<- cbind_dependencies(df_udp, type = "parent_rowid", recursive = TRUE)
df_udd_depend%>%
select(c(token_id, token, upos, dep_rel, parent_rowid, parent_rowids)) %>%
View()
df_udd_depend%>%
select(c(token_id, token, upos,stem, dep_rel, parent_rowid, parent_rowids)) %>%
View()
View(.[[7]][[1]])
View(.[[7]][[2]])
df_udd_depend
df_udp_depend
df_udp_depend<- cbind_dependencies(df_udp, type = "parent_rowid", recursive = TRUE)
edges <- subset(df_udp_depend, head_token_id != 0, select = c("token_id", "head_token_id", "dep_rel"))
edges$label <- edges$dep_rel
edges$dep_rel
g <- graph_from_data_frame(edges,
vertices = df_udp_depend[, c("token_id", "token", "lemma", "upos", "xpos", "feats")],
directed = TRUE)
g
g <- graph_from_data_frame(edges,
vertices = df_udp_depend[, c("token_id", "token", "lemma", "upos", "xpos", "feats")],
directed = TRUE)
df_udp_depend
df_udp_depend<- cbind_dependencies(df_udp, type = "parent_rowid", recursive = TRUE)
df_udp_depend
df_udp_depend
edges <- subset(df_udp_depend, head_token_id != 0, select = c("token_id", "head_token_id", "dep_rel"))
edges
edges$label <- edges$dep_rel
edges
df_udp_depend[, c("token_id", "token", "lemma", "upos", "xpos", "feats")]
g <- graph_from_data_frame(edges,
vertices = df_udp_depend[, c("token_id", "token", "lemma", "upos", "xpos", "feats")],
directed = TRUE)
edges
#Understanding dependency parsing for economy
df_econ<- df_udp_depend%>%
filter(stem=="economi")
edges <- subset(df_econ, head_token_id != 0, select = c("token_id", "head_token_id", "dep_rel"))
edges$label <- edges$dep_rel
g <- graph_from_data_frame(edges,
vertices = df_econ[, c("token", "lemma", "upos", "xpos", "feats")],
directed = TRUE)
edges
df_econ[, c("token", "lemma", "upos", "xpos", "feats")]
myvertices <- read.csv(stringsAsFactors=F, text="
id,name,feature_a,feature_b,feature_c
a,foo,1,2,3
b,bar,1,2,3
c,extra,1,2,3")
myedges <- read.csv(stringsAsFactors=F, text="
id,from,to,feature_d,feature_e,feature_f
1,a,b,1,2,3")
graph.data.frame(myedges[, -1], directed=TRUE, vertices=myvertices)
myvertices$id[3] <- "a" # duplicate a
graph.data.frame(myedges[, -1], directed=TRUE, vertices=myvertices)
myedges
myvertices
View(myvertices)
View(myedges)
myedges[, -1]
myedges
myedges[, -1]
myvertices
myedges[, -1]
graph.data.frame(myedges[, -1], directed=TRUE, vertices=myvertices)
myvertices <- read.csv(stringsAsFactors=F, text="
id,name,feature_a,feature_b,feature_c
a,foo,1,2,3
b,bar,1,2,3
c,extra,1,2,3")
myedges <- read.csv(stringsAsFactors=F, text="
id,from,to,feature_d,feature_e,feature_f
1,a,b,1,2,3")
graph.data.frame(myedges[, -1], directed=TRUE, vertices=myvertices)
myvertices$id[3] <- "a" # duplicate a
myvertices
myvertices$id[3] <- "a" #
myvertices
myvertices$id[3] <- "a" # duplicate a
myvertices$id[3]
myvertices$id
myvertices <- read.csv(stringsAsFactors=F, text="
id,name,feature_a,feature_b,feature_c
a,foo,1,2,3
b,bar,1,2,3
c,extra,1,2,3")
myvertices$id[3] <- "a"
df_econ
df_udp
df_udp
df_udp
df_udp%>%
group_by(upos)%>%
count()
df_udp%>%
filter(!lemma %in% stop_words,
!upos  %in% c("PUNCT", "CCONJ","NUM","SYM")) %>%
mutate_if(is.character, str_to_lower) %>%
document_term_frequencies(term = "token")
df_udp%>%
filter(!lemma %in% stop_words,
!upos  %in% c("PUNCT", "CCONJ","NUM","SYM")) %>%
#mutate_if(is.character, str_to_lower) %>%
document_term_frequencies(term = "token")
df_udp%>%
filter(!lemma %in% stop_words,
!upos  %in% c("PUNCT", "CCONJ","NUM","SYM")) %>%
#mutate_if(is.character, str_to_lower) %>%
document_term_frequencies(term = "token")%>%
arrange(desc(freq))
unnest_tokens(comp_text$text[1],bigrams, text, token="ngrams".n=2)
unnest_tokens(comp_text$text[1],bigrams, text, token="ngrams",n=2)
comp_text$text[1]
unnest_tokens(comp_text$text[1],bigrams, text, token="ngrams",n=2)
text_df=tibble(doc=i,text=temp$text)
text_df
unnest_tokens(text_df,bigrams, text, token="ngrams",n=2)
unnest_tokens(text_df,bigrams, text, token="ngrams",n=2)%>%
group_by(bigrams)%>%
count()
unnest_tokens(text_df,bigrams, text, token="ngrams",n=2)%>%
group_by(bigrams)%>%
count()%>%
arrange(desc(n))
install.packages("spData")
knitr::opts_chunk$set(echo = TRUE)
library(rvest)
library(dplyr)
library(stringr)
library(tidyverse)
library(RCurl)
library(readxl)
library(data.table)
library(sf)
library(spData)
library(scales)
library(plotly)
library(RJSONIO)
library(stringr)
library(tidytext)
library(ggrepel)
paste0(getwd(),"/raw_final.csv")
state_data<-read.csv(paste0(getwd(),"/raw_final.csv"))
state_data
colnames(state_data)
colnames(state_data)
cl_nam<-colnames(state_data)
cl_nam
str_split(cl_nam[4],"\\.")
length(str_split(cl_nam[4],"\\."))
count(str_split(cl_nam[4],"\\."))
(str_split(cl_nam[4],"\\."))
colname(str_split(cl_nam[4],"\\."))
(str_split(cl_nam[4],"\\."))
install.packages("h2o")
library(h2o)
h2o.init()
df = h2o.importFile("df_all.csv")
h2o.init()
df = h2o.importFile("df_all.csv")
library(h2o)
h2o.init()
unemp = read.csv("all-states2.csv")
setwd("~/GitHub/dataviz-class/Week4/Homework/pt1")
unemp = read.csv("all-states2.csv")
View(unemp)
library(tidyverse)
unemp_sum = unemp %>% group_by(end) %>% sum(value)
unemp_sum = unemp %>% group_by(end) %>% summarize(sum(value))
View(unemp_sum)
unemp_sum = unemp %>% group_by(end) %>% summarize(unemp = sum(value))
View(unemp_sum)
write.csv("all-states2_sum.csv")
write.csv(unemp_sum, "all-states2_sum.csv")
unemp_sum$date = unemp_sum$end
View(unemp_sum)
unemp_sum = unemp_sum %>% select(-end)
write.csv(unemp_sum, "all-states2_sum.csv")
unemp_sum = unemp %>% group_by(end) %>% summarize(value = sum(value))
unemp_sum$date = unemp_sum$end
unemp_sum = unemp_sum %>% select(-end)
write.csv(unemp_sum, "all-states2_sum.csv")
View(unemp_sum)
